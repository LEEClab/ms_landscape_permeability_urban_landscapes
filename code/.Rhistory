load("/home/bniebuhr/Documents/00_academico/01_artigos/ms_Pena_etal_corredores_OuroPreto/corridors/simulated_corridors/corridors_loaded.RData")
corr.txt.sem.zona
for(i in 1:length(corr.txt.sem.zona)) {
corr.txt.sem.zona[[i]]$zone <- 'Land cover'
corr.txt.com.zona[[i]]$zone <- 'Land cover + urban zone'
tt <- rbind(corr.txt.sem.zona[[i]], corr.txt.com.zona[[i]])
tt$sp <- sp[i]
if(i == 1) {
tab <- tt
} else {
tab <- rbind(tab, tt)
}
}
corr.txt.sem.zona
corr.txt.sem.zona
for(i in 1:length(corr.txt.sem.zona)) {
corr.txt.sem.zona[[i]]$zone <- 'Land cover'
corr.txt.com.zona[[i]]$zone <- 'Land cover + urban zone'
tt <- rbind(corr.txt.sem.zona[[i]], corr.txt.com.zona[[i]])
tt$sp <- sp[i]
if(i == 1) {
tab <- tt
} else {
tab <- rbind(tab, tt)
}
}
tab
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp) +
labs(x = '', y = 'Relative corridor cost')
library(ggplot2)
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp) +
labs(x = '', y = 'Relative corridor cost')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp) +
labs(x = '', y = 'Relative corridor cost')
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Functional connectivity index')
# Tortuosity
ggplot() +
geom_jitter(data = tab[tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH <= 1,], aes(x = zone, y = CORRIDOR_LENGTH/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH
tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH %>% range
library(dplyr)
tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH %>% range
tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH
tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH %>% max
max(tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH)
range(tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH)
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = CORRIDOR_LENGTH/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = new.corr.length/new.eucl.dist)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
# Without Zone
corr.shp.sem.zona
for(i in 1:length(corr.shp.sem.zona)) {
corr.txt.sem.zona[[i]]$new.eucl.dist <- NA
corr.txt.sem.zona[[i]]$new.corr.length <- NA
list.corrs <- corr.shp.sem.zona[[i]]
for(j in 1:length(list.corrs)) {
print(paste(i, j))
shp <- list.corrs[[j]]
tbl <- coordinates(shp)[[1]][[1]]
Euc.dst <- dist(tbl[c(1, nrow(tbl)),])
Tot.len <- gLength(shp)
corr.txt.sem.zona[[i]]$new.eucl.dist[j] <- Euc.dst
corr.txt.sem.zona[[i]]$new.corr.length[j] <- Tot.len
}
}
??gLength
install.load::install_load('raster', 'sp', 'rgdal', 'GISTools', 'rgeos', 'trajectories', 'spacetime', 'spatstat')
# Without Zone
corr.shp.sem.zona
for(i in 1:length(corr.shp.sem.zona)) {
corr.txt.sem.zona[[i]]$new.eucl.dist <- NA
corr.txt.sem.zona[[i]]$new.corr.length <- NA
list.corrs <- corr.shp.sem.zona[[i]]
for(j in 1:length(list.corrs)) {
print(paste(i, j))
shp <- list.corrs[[j]]
tbl <- coordinates(shp)[[1]][[1]]
Euc.dst <- dist(tbl[c(1, nrow(tbl)),])
Tot.len <- gLength(shp)
corr.txt.sem.zona[[i]]$new.eucl.dist[j] <- Euc.dst
corr.txt.sem.zona[[i]]$new.corr.length[j] <- Tot.len
}
}
length(list.corrs)
list.corrs
for(i in 1:length(corr.shp.sem.zona)) {
corr.txt.sem.zona[[i]]$new.eucl.dist <- NA
corr.txt.sem.zona[[i]]$new.corr.length <- NA
list.corrs <- corr.shp.sem.zona[[i]]
for(j in 1:length(list.corrs)) {
print(paste(i, j))
shp <- list.corrs[[j]]
tbl <- coordinates(shp)[[1]][[1]]
Euc.dst <- dist(tbl[c(1, nrow(tbl)),])
Tot.len <- gLength(shp)
corr.txt.sem.zona[[i]]$new.eucl.dist[j] <- Euc.dst
corr.txt.sem.zona[[i]]$new.corr.length[j] <- Tot.len
}
}
list.corrs
corr.txt.sem.zona[[i]]
# add 900 lines to S.scansor table
nc <- ncol(corr.txt.sem.zona[[4]])
nc
nr <- nrow(corr.txt.sem.zona[[4]])
nr
cnames <- colnames(corr.txt.sem.zona[[4]])
cnames
matrix(NA, nr, nc, dimnames = list(101:1000, cnames)
)
cnames
101:1000
101:1000 %>% length
matrix(NA, nr, nc, dimnames = list(101:1000, cnames))
?matrix
matrix(NA, nr, nc, dimnames = list(c(101:1000), cnames))
matrix(NA, nr, nc)#, dimnames = list(c(101:1000), cnames))
nr <- 900
cnames <- colnames(corr.txt.sem.zona[[4]])
matrix(NA, nr, nc, dimnames = list(c(101:1000), cnames))
as.data.frame(matrix(NA, nr, nc, dimnames = list(c(101:1000), cnames)))
# add 900 lines to S.scansor table
nc <- ncol(corr.txt.sem.zona[[4]])
nr <- 900
cnames <- colnames(corr.txt.sem.zona[[4]])
corr.txt.sem.zona[[4]] <- rbind(corr.txt.sem.zona[[4]], as.data.frame(matrix(NA, nr, nc, dimnames = list(c(101:1000), cnames)))_
corr.txt.sem.zona[[4]] <- rbind(corr.txt.sem.zona[[4]], as.data.frame(matrix(NA, nr, nc, dimnames = list(c(101:1000), cnames))))
for(i in 1:length(corr.shp.sem.zona)) {
corr.txt.sem.zona[[i]]$new.eucl.dist <- NA
corr.txt.sem.zona[[i]]$new.corr.length <- NA
list.corrs <- corr.shp.sem.zona[[i]]
for(j in 1:length(list.corrs)) {
print(paste(i, j))
shp <- list.corrs[[j]]
tbl <- coordinates(shp)[[1]][[1]]
Euc.dst <- dist(tbl[c(1, nrow(tbl)),])
Tot.len <- gLength(shp)
corr.txt.sem.zona[[i]]$new.eucl.dist[j] <- Euc.dst
corr.txt.sem.zona[[i]]$new.corr.length[j] <- Tot.len
}
}
# With Zone
corr.shp.com.zona
for(i in 1:length(corr.shp.com.zona)) {
corr.txt.com.zona[[i]]$new.eucl.dist <- NA
corr.txt.com.zona[[i]]$new.corr.length <- NA
list.corrs <- corr.shp.com.zona[[i]]
for(j in 1:length(list.corrs)) {
print(paste(i, j))
shp <- list.corrs[[j]]
tbl <- coordinates(shp)[[1]][[1]]
Euc.dst <- dist(tbl[c(1, nrow(tbl)),])
Tot.len <- gLength(shp)
corr.txt.com.zona[[i]]$new.eucl.dist[j] <- Euc.dst
corr.txt.com.zona[[i]]$new.corr.length[j] <- Tot.len
}
}
sp <- c('A. leucophthalmus', 'C. caudata', 'P. leucoptera', 'S. scansor', 'X. fuscus')
for(i in 1:length(corr.txt.sem.zona)) {
corr.txt.sem.zona[[i]]$zone <- 'Land cover'
corr.txt.com.zona[[i]]$zone <- 'Land cover + urban zone'
tt <- rbind(corr.txt.sem.zona[[i]], corr.txt.com.zona[[i]])
tt$sp <- sp[i]
if(i == 1) {
tab <- tt
} else {
tab <- rbind(tab, tt)
}
}
head(tab)
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp) +
labs(x = '', y = 'Relative corridor cost')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp) +
labs(x = '', y = 'Relative corridor cost')
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Functional connectivity index')
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = new.eucl.dist/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = EUCLIDEAN_DISTANCE/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = new.eucl.dist/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Functional connectivity index')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/new.eucl.dist)) +
facet_wrap(~sp) +
labs(x = '', y = 'Functional connectivity index')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/new.eucl.dist)) +
facet_wrap(~sp) +
ylim(0, 100) +
labs(x = '', y = 'Functional connectivity index')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/new.eucl.dist)) +
facet_wrap(~sp) +
ylim(0, 20) +
labs(x = '', y = 'Functional connectivity index')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/new.eucl.dist)) +
facet_wrap(~sp) +
ylim(0, 3) +
labs(x = '', y = 'Functional connectivity index')
# Tortuosity
ggplot() +
geom_jitter(data = tab[tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH <= 1,], aes(x = zone, y = CORRIDOR_LENGTH/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = CORRIDOR_LENGTH/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = new.corr.length/new.eucl.dist)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
g2 <- ggplot() +
geom_boxplot(data = tab[tab$EUCLIDEAN_DISTANCE/tab$CORRIDOR_LENGTH <= 1,], aes(x = zone, y = CORRIDOR_LENGTH/EUCLIDEAN_DISTANCE)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
g2
tab$new.corr.length/tab$new.eucl.dist
range(tab$new.corr.length/tab$new.eucl.dist)
range(tab$new.corr.length/tab$new.eucl.dist, na.rm = T)
tab.test <- tab[tab$new.corr.length/tab$new.eucl.dist < 3,] %>%
filter(!is.na(.$new.eucl.dist))
g2 <- ggplot() +
geom_boxplot(data = tab.test, aes(x = zone, y = new.corr.length/new.eucl.dist)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Tortuosity')
g2
tab.test <- tab[tab$new.corr.length/tab$new.eucl.dist < 20,] %>%
filter(!is.na(.$new.eucl.dist))
g2 <- ggplot() +
geom_boxplot(data = tab.test, aes(x = zone, y = new.corr.length/new.eucl.dist)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Tortuosity')
g2
g3 <- ggplot() +
geom_boxplot(data = tab.test, aes(color = zone, y = new.corr.length/new.eucl.dist, x = sp)) +
labs(x = '', y = 'Tortuosity') +
scale_color_manual(values = c('darkgreen', 'red'))
g3
tab.test <- tab[tab$new.corr.length/tab$new.eucl.dist < 3,]
(a <- glm(new.corr.length/new.eucl.dist ~ zone * sp - 1, data = tab.test)) %>% summary
cf <- coef(a)
cf[3:6] <- cf[3:6] + cf[1]
cf[7:10] <- cf[7:10] + cf[2]
cf
ggplot() +
geom_jitter(data = tab, aes(x = zone, y = new.corr.length/new.eucl.dist)) +
facet_wrap(~sp) +
labs(x = '', y = 'Tortuosity')
ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = CORRIDOR_COST/new.eucl.dist)) +
facet_wrap(~sp) +
ylim(0, 3) +
labs(x = '', y = 'Functional connectivity index')
g1 <- ggplot() +
geom_boxplot(data = tab, aes(x = zone, y = new.eucl.dist/CORRIDOR_COST)) +
facet_wrap(~sp, scales = 'free') +
labs(x = '', y = 'Relative corridor cost')
g1
ggsave(paste0(outdir, 'relative_corridor_cost_new_dist.png'), plot = g1, device = 'png', width = 20, height = 15, units = 'cm', dpi = 300)
outdir
